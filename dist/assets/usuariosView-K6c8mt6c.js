import{_ as U,g as V,c as i,b as s,w as h,v as A,d as k,F as g,r as _,K as B,e as y,i as M,U as $,L as q,a as x,m as D,l as d,o as l,t as n,n as S}from"./index-crUL-HRR.js";const F={class:"container mt-5"},I={class:"mb-4"},L={class:"box"},T={class:"columns is-vcentered"},z={class:"column is-4"},G={class:"control has-icons-left"},P={class:"column is-3"},R={class:"select is-fullwidth"},j=["value"],K={class:"column is-3"},H={class:"select is-fullwidth"},J={class:"table-container box p-0",style:{position:"relative","min-height":"200px"}},O={key:0,class:"is-overlay has-background-white-ter is-flex is-align-items-center is-justify-content-center",style:{"z-index":"10",opacity:"0.7"}},Q={class:"table is-fullwidth is-hoverable is-striped"},W={key:0},X={class:"is-vcentered"},Y={class:"is-vcentered"},Z={class:"is-vcentered"},ss={class:"tag is-info is-light"},ts={class:"is-vcentered"},es={class:"tags"},os=["title"],as={class:"has-text-centered is-vcentered"},ls={class:"has-text-centered is-vcentered"},is={class:"has-text-right is-vcentered"},ns=["onClick"],rs={__name:"usuariosView",setup(ds){const p=d([]),f=d([]),b=d([]),a=D({q:"",curso:"",division:""}),c=d(!1),u=d(!1),m=d(null),r=async()=>{c.value=!0;try{const o=await q.getAll(a);p.value=o.data}catch(o){console.error("Error al cargar usuarios",o)}finally{c.value=!1}},w=async()=>{try{const[o,t]=await Promise.all([x.get("/common/escuelas"),x.get("/common/roles")]);f.value=o.data,b.value=t.data}catch(o){console.error("Error cargando maestras",o)}},C=()=>{m.value=null,u.value=!0},E=o=>{m.value={...o},u.value=!0},N=()=>{a.q="",a.curso="",a.division="",r()};return V(()=>{r(),w()}),(o,t)=>(l(),i("div",F,[s("div",I,[s("button",{class:"button is-small is-light mb-3",onClick:t[0]||(t[0]=e=>o.$router.back())},[...t[5]||(t[5]=[s("span",{class:"icon is-small"},[s("i",{class:"fas fa-arrow-left"})],-1),s("span",null,"Volver",-1)])])]),s("div",{class:"level"},[t[7]||(t[7]=s("div",{class:"level-left"},[s("h1",{class:"title"},"Gestión de Usuarios")],-1)),s("div",{class:"level-right"},[s("button",{class:"button is-primary",onClick:C},[...t[6]||(t[6]=[s("span",{class:"icon"},[s("i",{class:"fas fa-user-plus"})],-1),s("span",null,"Nuevo Usuario",-1)])])])]),s("div",L,[s("div",T,[s("div",z,[s("div",G,[h(s("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>a.q=e),class:"input",type:"text",placeholder:"Buscar por nombre, apellido o email...",onInput:r},null,544),[[A,a.q]]),t[8]||(t[8]=s("span",{class:"icon is-left"},[s("i",{class:"fas fa-search"})],-1))])]),s("div",P,[s("div",R,[h(s("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>a.curso=e),onChange:r},[t[9]||(t[9]=s("option",{value:""},"Todos los Cursos",-1)),(l(),i(g,null,_(6,e=>s("option",{key:e,value:e+"to"},n(e)+"to Año",9,j)),64))],544),[[k,a.curso]])])]),s("div",K,[s("div",H,[h(s("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>a.division=e),onChange:r},[...t[10]||(t[10]=[B('<option value="" data-v-afcdb4fb>Todas las Divisiones</option><option value="1ra" data-v-afcdb4fb>1ra</option><option value="2da" data-v-afcdb4fb>2da</option><option value="3ra" data-v-afcdb4fb>3ra</option><option value="4ta" data-v-afcdb4fb>4ta</option><option value="A" data-v-afcdb4fb>A</option><option value="B" data-v-afcdb4fb>B</option><option value="C" data-v-afcdb4fb>C</option>',8)])],544),[[k,a.division]])])]),s("div",{class:"column is-2"},[s("button",{class:"button is-link is-light is-fullwidth",onClick:N}," Limpiar ")])])]),s("div",J,[c.value?(l(),i("div",O,[...t[11]||(t[11]=[s("div",{class:"loader",style:{width:"3rem",height:"3rem","border-width":"4px"}},null,-1)])])):y("",!0),s("table",Q,[t[14]||(t[14]=s("thead",{class:"has-background-light"},[s("tr",null,[s("th",null,"Apellido, Nombre"),s("th",null,"Email"),s("th",null,"Rol"),s("th",null,"Escuela/s"),s("th",{class:"has-text-centered"},"Curso/Div"),s("th",{class:"has-text-centered"},"Estado"),s("th",{class:"has-text-right"},"Acciones")])],-1)),s("tbody",null,[p.value.length===0&&!c.value?(l(),i("tr",W,[...t[12]||(t[12]=[s("td",{colspan:"7",class:"has-text-centered py-5 has-text-grey"}," No se encontraron usuarios con los filtros aplicados. ",-1)])])):y("",!0),(l(!0),i(g,null,_(p.value,e=>(l(),i("tr",{key:e.id},[s("td",X,[s("strong",null,n(e.apellido?e.apellido+", ":"")+n(e.nombre),1)]),s("td",Y,n(e.email),1),s("td",Z,[s("span",ss,n(e.rol?.nombre),1)]),s("td",ts,[s("div",es,[(l(!0),i(g,null,_(e.escuelas,v=>(l(),i("span",{key:v.id,class:"tag is-info is-light",title:"Nombre oficial: "+v.nombre_largo},n(v.nombre_corto),9,os))),128))])]),s("td",as,n(Number(e.rol_id)===3?`${e.curso||""} ${e.division||""}`:"-"),1),s("td",ls,[s("span",{class:S(["tag",e.activo?"is-success":"is-danger"])},n(e.activo?"Activo":"Inactivo"),3)]),s("td",is,[s("button",{class:"button is-small is-warning is-light",onClick:v=>E(e)},[...t[13]||(t[13]=[s("span",{class:"icon is-small"},[s("i",{class:"fas fa-edit"})],-1)])],8,ns)])]))),128))])])]),b.value.length>0&&f.value.length>0?(l(),M($,{key:0,"is-active":u.value,"usuario-edit":m.value,escuelas:f.value,roles:b.value,onClose:t[4]||(t[4]=e=>u.value=!1),onUsuarioGuardado:r},null,8,["is-active","usuario-edit","escuelas","roles"])):y("",!0)]))}},us=U(rs,[["__scopeId","data-v-afcdb4fb"]]);export{us as default};
